---
name: work-on-pr
description: GitHub PR 번호를 받아 리뷰 분석부터 추가 커밋 및 코멘트까지 전체 리뷰 대응 워크플로우를 단계별로 진행합니다. 각 단계에서 개발자 확인을 받으며 진행합니다.
user-invocable: true
---

# GitHub PR 리뷰 대응 워크플로우

이 스킬은 GitHub PR 번호를 받아 **PR 분석 → 브랜치 체크아웃 → 작업 계획 → 구현 → 푸시 → PR 코멘트**까지의 전체 리뷰 대응 워크플로우를 오케스트레이션합니다.

**인자**: `$ARGUMENTS`에서 PR 번호를 받습니다. (예: `/work-on-pr 42`)

> **중요**: 각 단계가 끝날 때마다 결과를 개발자에게 보고하고, **다음 단계로 진행할지 확인**을 받으세요. 개발자가 수정을 요청하면 해당 단계를 조정한 후 다시 확인을 받으세요.

> **필수**: 4단계에서 하나의 작업 단위를 구현하면, **같은 응답 안에서 즉시** `auto-committer` 에이전트를 호출하여 커밋하세요. 구현 후 커밋 전에 사용자에게 메시지를 보내는 것은 **금지**입니다.

## 워크플로우 진행 추적

> **필수**: 워크플로우 시작 시 아래 6개 단계를 **TaskCreate로 모두 등록**하세요. Plan 모드 등 컨텍스트 경계를 넘어도 태스크 리스트가 유지되어 남은 단계를 놓치지 않습니다.

워크플로우를 시작하면 **가장 먼저** 다음 6개 태스크를 TaskCreate로 생성합니다:

1. `PR 분석` — pr-fetcher 호출 → 개발자 확인
2. `브랜치 체크아웃` — git fetch + git checkout + git pull → 개발자 확인
3. `작업 계획 수립` — Plan 모드 → 개발자 승인
4. `구현 및 커밋` — description에 반드시 다음을 포함:
   "⚠️ 각 작업 단위를 구현한 직후, 같은 응답에서 반드시 auto-committer 에이전트를 Task 도구로 호출하세요. 구현 후 커밋 전에 텍스트를 출력하면 턴이 종료되어 커밋이 누락됩니다. 반드시 [구현 → auto-committer 호출 → 텍스트 출력] 순서를 지키세요."
5. `원격 푸시` — 새 커밋 목록 제시 → 개발자 확인 → git push
6. `PR 코멘트` — 리뷰 대응 요약 코멘트 작성 → 개발자 확인

각 단계를 **시작할 때 `in_progress`**, **완료할 때 `completed`**로 TaskUpdate하세요. 단계 진행 전 반드시 TaskList를 확인하여 현재 진행 상황을 파악하세요.

> **필수 — 워크플로우 연속 규칙**: 어떤 단계를 완료하든, **6개 태스크가 모두 `completed`가 될 때까지 워크플로우를 종료하지 마세요.** 각 단계의 확인 포인트에서 개발자 확인을 받은 뒤, 즉시 TaskList를 호출하여 다음 미완료 단계를 확인하고 진행하세요.

## 전제 조건

- `gh` CLI가 설치되고 인증된 상태여야 합니다.
- 현재 디렉토리가 Git 리포지토리여야 합니다.
- `$ARGUMENTS`가 비어있으면 개발자에게 PR 번호를 질문하세요.

## 워크플로우

### 1단계: PR 분석

`pr-fetcher` 에이전트를 호출하여 PR 상세 정보와 리뷰를 분석합니다.

1. `pr-fetcher` 에이전트에 PR 번호를 전달하여 실행합니다.
1. 에이전트가 반환한 PR 리뷰 요약을 개발자에게 제시합니다.
1. **확인 포인트**: "PR 리뷰 분석 결과를 확인해 주세요. 이 리뷰 피드백을 바탕으로 작업을 진행할까요?"

### 2단계: 브랜치 체크아웃

PR의 작업 브랜치를 로컬에 체크아웃합니다.

1. `git fetch origin`으로 원격 정보를 업데이트합니다.
1. `git checkout <headRefName>`으로 PR 브랜치를 체크아웃합니다.
1. `git pull origin <headRefName>`으로 최신 상태로 동기화합니다.
1. 현재 브랜치 상태를 개발자에게 제시합니다.
1. **확인 포인트**: "PR 브랜치 `<headRefName>`을 체크아웃했습니다. 다음 단계로 진행할까요?"

### 3단계: 작업 계획 수립

리뷰 피드백을 기반으로 구현 계획을 작성합니다.

1. Plan 모드로 전환하여 리뷰 피드백에 대한 수정 계획을 수립합니다.
1. 인라인 코멘트에서 언급된 파일과 라인을 탐색합니다.
1. 리뷰 피드백별 수정 사항을 단계별로 정리합니다.
1. **구현 계획에 다음 규칙을 반드시 포함하세요**: "각 작업 단위를 구현한 직후, 같은 응답에서 auto-committer 에이전트를 호출하여 커밋한다."
1. **확인 포인트**: Plan 모드의 승인 절차를 통해 개발자가 계획을 검토하고 승인합니다.

> **필수**: Plan 모드에서 복귀한 후, 다음 3가지를 **반드시** 순서대로 수행하세요:
> 1. 이 SKILL 파일을 다시 읽으세요: `.claude/skills/work-on-pr`
> 2. **TaskList**를 호출하여 현재 워크플로우 진행 상황을 파악하세요
> 3. 4단계(구현 및 커밋) 태스크를 **TaskGet**으로 읽어 auto-committer 호출 규칙을 확인하세요

### 4단계: 구현 및 커밋

승인된 계획에 따라 리뷰 피드백을 반영하고 커밋합니다.

> **금지**: 코드를 수정한 뒤 `auto-committer`를 호출하지 않은 채 사용자에게 메시지를 보내는 것은 **금지**입니다. 구현과 커밋은 반드시 **하나의 응답 안에서** 연속으로 수행하세요.

1. 계획의 작업 단위를 하나 구현합니다.
1. **같은 응답에서 즉시** `auto-committer` 에이전트(git-workflow 플러그인)를 호출하여 커밋합니다. 사용자에게 중간 보고하지 마세요.
1. 남은 작업 단위가 있으면 1~2를 반복합니다.
1. 모든 작업 단위의 구현과 커밋이 끝나면, `git status`로 커밋되지 않은 변경사항이 없는지 확인합니다.
1. 구현 중 계획과 다른 부분이 생기면 개발자에게 보고하고 조정합니다.
1. **확인 포인트**: "모든 리뷰 피드백의 반영과 커밋이 완료되었습니다. 변경 사항을 검토해 주세요."

> **필수**: 구현과 커밋이 완료되어도 **워크플로우가 끝난 것이 아닙니다.** 개발자 확인 후 반드시 TaskList를 호출하고, 5단계(원격 푸시)로 즉시 진행하세요.

### 5단계: 원격 푸시

추가 커밋을 원격 리포지토리에 푸시합니다.

1. `git log origin/<headRefName>..HEAD --oneline`으로 푸시할 새 커밋 목록을 개발자에게 보여줍니다.
1. **확인 포인트**: "위 커밋들을 원격에 푸시할까요?"
1. 승인 후 `git push origin <headRefName>`을 실행합니다.
1. 푸시 결과를 보고합니다.

### 6단계: PR 코멘트

추가 커밋을 요약하는 코멘트를 PR에 작성합니다.

1. `git log origin/<headRefName>..HEAD --oneline`의 결과(푸시 전에 저장해둔 목록)를 기반으로 코멘트를 작성합니다.
1. 코멘트 내용을 개발자에게 미리 제시합니다. 코멘트 형식:

```
## 리뷰 피드백 반영 완료

다음 리뷰 피드백을 반영하여 추가 커밋을 푸시했습니다.

### 반영된 피드백
- <리뷰 피드백 1 요약>
- <리뷰 피드백 2 요약>
- ...

### 추가된 커밋
- `<commit-hash>` <commit-message>
- `<commit-hash>` <commit-message>
- ...

확인 부탁드립니다. 🙏
```

3. **확인 포인트**: "위 코멘트를 PR에 작성할까요?"
4. 승인 후 `gh pr comment <number> --body "..."` 명령어로 코멘트를 작성합니다.
5. 코멘트 작성 결과를 보고합니다.

## 완료 보고

모든 단계가 완료되면 최종 요약을 제시합니다:

```
## 워크플로우 완료

- **PR**: #<number> <title>
- **브랜치**: <headRefName>
- **추가 커밋 수**: <number of new commits>
- **반영된 리뷰 피드백 수**: <number of addressed feedbacks>
```

## 중단 및 재개

- 개발자가 특정 단계에서 중단을 요청하면, 현재까지의 진행 상황을 요약하고 중단합니다.
- 이미 완료된 단계는 건너뛰지 않습니다. (예: 이미 브랜치에 있으면 2단계 건너뛰기)
- 에이전트 호출이 실패하면 에러를 보고하고 개발자의 지시를 기다립니다.
